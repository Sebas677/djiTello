# Python program to open the
# camera in Tkinter
# Import the libraries,
# tkinter, cv2, Image and ImageTk

from tkinter import *
from djitellopy import tello,TelloSwarm
import time


swarm=tello.Tello()

swarm = TelloSwarm.fromIps([
    "192.168.137.103",
    "192.168.137.149",
    "192.168.137.237",
    "192.168.137.175"
])

swarm.connect()

#set speed fot the joypad controls
speed=20

# Declare the width and height in variables
width, height = 500, 600


# Create a GUI app
app = Tk()

# Bind the app with Escape keyboard to
# quit app whenever pressed
app.bind('<Escape>', lambda e: app.quit())
app.title ('Tello Talent')
app.geometry('400x350')
app.config (background='gray')


#____EXECUTE
def control_TAKEOFF():
    swarm.takeoff()
def control_LAND():
    swarm.land()

#____CONTROL  
def control_LEFT():
    swarm.send_rc_control(-speed,0,0,0)
    time.sleep(0.2)
def control_RIGHT():
    swarm.send_rc_control(speed,0,0,0)
    time.sleep(0.2)
def control_UP():
    swarm.send_rc_control(0,0,speed,0)
    time.sleep(0.2)
def control_DOWN():
    swarm.send_rc_control(0,0,-speed,0)
    time.sleep(0.2)
def control_turnLeft():
    swarm.send_rc_control(0,0,0,-speed)
    time.sleep(0.2)
def control_turnRight():
    swarm.send_rc_control(0,0,0,speed) 
    time.sleep(0.2)
def control_front():
    swarm.send_rc_control(0,speed,0,0)
    time.sleep(0.2)
def control_back():
    swarm.send_rc_control(0,-speed,0,0)
    time.sleep(0.2)

#____TRAJECTORIES
def line_traj():
    distance = int(input())
    swarm.send_rc_control(0,distance,0,0)
    time.sleep(3)

def triangle_traj():

    distance = int(input())

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 60 degrees
    swarm.rotate_clockwise(60)
    time.sleep(3)

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 60 degrees
    swarm.rotate_clockwise(60)
    time.sleep(3)

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 60 degrees
    swarm.rotate_clockwise(60)
    time.sleep(3)


def hexagon_traj():

    distance = int(input())

    swarm.rotate_clockwise(300)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(90)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(60)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(60)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(60)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(70)
    time.sleep(2)
    swarm.move_forward(distance)
    time.sleep(2)
    swarm.rotate_clockwise(90)

def square_traj():

    distance = int(input())

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 90 degrees
    swarm.rotate_clockwise(90)
    time.sleep(3)


    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 90 degrees
    swarm.rotate_clockwise(90)
    time.sleep(3)

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 90 degrees
    swarm.rotate_clockwise(90)
    time.sleep(3)

    swarm.move_forward(distance)
    time.sleep(3)
    # Rotate clockwise by 90 degrees
    swarm.rotate_clockwise(90)
    time.sleep(3)


def circle_traj():        
    swarm.send_rc_control(5, 15, 0, 40)
    time.sleep(10)



app.columnconfigure((0, 1, 2, 3, 4, 5,6,7,8,9,10), weight=1)
app.rowconfigure((0, 1, 2, 3,4,5,6,7,8,9,10), weight=1)

# Create a label and display it on app
label_widget = Label(app)
label_widget.grid(column=4,row=2)
label_widget.config(background='gray')


# Create a button to takeoff in GUI app
button2 = Button(app, text="≙",activebackground= "red", command=control_TAKEOFF) #activebackground= "red"
button2.grid(column=3, row=5)


# Create a button to land in GUI app
button3 = Button(app, text="≚",activebackground= "red", command=control_LAND)
button3.grid(column=5, row=5)

# Create a button to move to the left in GUI app
button4 = Button(app, text="≪",activebackground= "red", command=control_LEFT)
button4.grid(column=1, row=2)
time.sleep(0.5)

# Create a button to move to the right in GUI app
button5 = Button(app, text="≫",activebackground= "red", command=control_RIGHT)
button5.grid(column=3, row=2)
time.sleep(0.5)

# Create a button to go forward in GUI app
button6 = Button(app, text="⊼",activebackground= "red", command=control_front)
button6.grid(column=2, row=1)
time.sleep(0.5)

# Create a button to go backward in GUI app
button7 = Button(app, text="⊽",activebackground= "red", command=control_back)
button7.grid(column=2, row=3)
time.sleep(0.5)

# Create a button to ascend in GUI app
button8 = Button(app, text="↥",activebackground= "red", command=control_UP)
button8.grid(column=6, row=1)
time.sleep(0.5)

# Create a button to descend GUI app
button9 = Button(app, text="↧",activebackground= "red", command=control_DOWN)
button9.grid(column=6, row=3)
time.sleep(0.5)

# Create a button to rotate counter-clockwise in GUI app
button10 = Button(app, text="⟲",activebackground= "red", command=control_turnLeft)
button10.grid(column=5, row=2)
time.sleep(0.5)

# Create a button to rotate clockwise in GUI app
button11 = Button(app, text="⟳",activebackground= "red", command=control_turnRight)
button11.grid(column=7, row=2)
time.sleep(0.5)


div0=Label(app,text=" ")
div0.grid(column=4, row=6)
div0.config(background='gray')
div1=Label(app,text=" ")
div1.grid(column=8, row=6)
div1.config(background='gray')


traj=Label(app, text="TRAJEC")
traj.grid(column=0,row=9)

line= Button(app, text="│",activebackground= "red", command=line_traj)
line.grid(column=1,row=9)

triang= Button(app, text="△",activebackground= "red", command=triangle_traj)
triang.grid(column=2,row=9)

hex= Button(app, text="⎔",activebackground= "red", command=hexagon_traj)
hex.grid(column=3,row=9)

square= Button(app, text="☐",activebackground= "red", command=square_traj)
square.grid(column=4,row=9)

circle= Button(app, text="⊙",activebackground= "red", command=circle_traj)
circle.grid(column=5,row=9)


# Create an infinite loop for displaying app on screen
app.mainloop()